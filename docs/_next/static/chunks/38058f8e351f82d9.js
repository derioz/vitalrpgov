(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98723,e=>{"use strict";var t=e.i(43476),l=e.i(71645),s=e.i(11152),a=e.i(32341);e.i(36180);var r=e.i(98925),i=e.i(59141),o=e.i(22016);function n(){let{userProfile:e}=(0,a.useAuth)(),[n,c]=(0,l.useState)([{label:"Total Users",value:"-",icon:s.FaUsers,color:"blue",trend:"..."},{label:"Active Complaints",value:"-",icon:s.FaExclamationCircle,color:"amber",trend:"..."},{label:"Total Personnel",value:"-",icon:s.FaUserShield,color:"purple",trend:"..."},{label:"Open Jobs",value:"-",icon:s.FaBriefcase,color:"emerald",trend:"..."}]),[d,m]=(0,l.useState)([]),[x,p]=(0,l.useState)(!0),h=e?.roles?.includes("superadmin");e?.roles?.includes("admin");let u=e?.roles?.filter(e=>["lspd","lsems","safd","doj"].includes(e)).map(e=>e.toUpperCase())||[],b=async()=>{if(e){p(!0);try{let e,t,l,a,o,n="Restricted";if(h)try{n=(await (0,r.getCountFromServer)((0,r.collection)(i.db,"users"))).data().count.toLocaleString()}catch(e){console.warn("User count failed",e)}else n="N/A";e=h?(0,r.query)((0,r.collection)(i.db,"complaints"),(0,r.where)("status","!=","Resolved")):u.length>0?(0,r.query)((0,r.collection)(i.db,"complaints"),(0,r.where)("status","!=","Resolved"),(0,r.where)("department","in",u)):null;let d="-";e&&(d=(await (0,r.getCountFromServer)(e)).data().count.toString()),t=h?(0,r.query)((0,r.collection)(i.db,"rosters")):u.length>0?(0,r.query)((0,r.collection)(i.db,"rosters"),(0,r.where)("department","in",u)):null;let x="-";t&&(x=(await (0,r.getCountFromServer)(t)).data().count.toString()),l=h?(0,r.query)((0,r.collection)(i.db,"jobs")):u.length>0?(0,r.query)((0,r.collection)(i.db,"jobs"),(0,r.where)("department","in",u)):null;let p="-";l&&(p=(await (0,r.getCountFromServer)(l)).data().count.toString()),c([{label:"Total Users",value:n,icon:s.FaUsers,color:"blue",trend:h?"Registered":"Hidden"},{label:"Active Complaints",value:d,icon:s.FaExclamationCircle,color:"amber",trend:"Pending"},{label:"Personnel",value:x,icon:s.FaUserShield,color:"purple",trend:"On Roster"},{label:"Open Jobs",value:p,icon:s.FaBriefcase,color:"emerald",trend:"Available"}]);let b=[];h?a=(0,r.query)((0,r.collection)(i.db,"complaints"),(0,r.orderBy)("createdAt","desc"),(0,r.limit)(50)):u.length>0&&(a=(0,r.query)((0,r.collection)(i.db,"complaints"),(0,r.where)("department","in",u),(0,r.orderBy)("createdAt","desc"),(0,r.limit)(50))),a&&(await (0,r.getDocs)(a)).forEach(e=>{let t=e.data();b.push({id:e.id,type:"complaint",department:t.department,description:`Complaint #${t.accessCode||e.id.substring(0,6)}`,timestamp:t.createdAt,author:"System"})}),h?o=(0,r.query)((0,r.collection)(i.db,"announcements"),(0,r.orderBy)("createdAt","desc"),(0,r.limit)(50)):u.length>0&&(o=(0,r.query)((0,r.collection)(i.db,"announcements"),(0,r.where)("department","in",u),(0,r.orderBy)("createdAt","desc"),(0,r.limit)(50))),o&&(await (0,r.getDocs)(o)).forEach(e=>{let t=e.data();b.push({id:e.id,type:"announcement",department:t.department,description:`Announcement: "${t.title}"`,timestamp:t.createdAt,author:t.author||"Admin"})}),b.sort((e,t)=>{let l=e.timestamp?.seconds||0;return(t.timestamp?.seconds||0)-l}),m(b.slice(0,7))}catch(e){console.error("Dashboard fetch error:",e)}finally{p(!1)}}};(0,l.useEffect)(()=>{b()},[e,h]);let[g,f]=(0,l.useState)(1),v=Math.ceil(d.length/5),j=d.slice((g-1)*5,5*g);return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-slate-200",children:["Overview",u.length>0&&!h&&(0,t.jsxs)("span",{className:"text-sm font-normal text-slate-500 ml-2",children:["(",u.join(", "),")"]}),h&&(0,t.jsx)("span",{className:"text-sm font-normal text-slate-500 ml-2",children:"(Global Access)"})]}),x&&(0,t.jsxs)("div",{className:"text-indigo-400 flex items-center gap-2 text-sm",children:[(0,t.jsx)(s.FaSpinner,{className:"animate-spin"})," Syncing data..."]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:n.map((e,l)=>(0,t.jsxs)("div",{className:"bg-zinc-900/40 backdrop-blur-xl border border-white/10 p-6 rounded-3xl relative overflow-hidden group hover:bg-zinc-800/40 transition-all duration-300",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:(0,t.jsx)(e.icon,{className:`text-6xl text-${e.color}-500 transform rotate-12`})}),(0,t.jsxs)("div",{className:"relative z-10",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("div",{className:`p-3 rounded-xl bg-${e.color}-500/10 text-${e.color}-500 border border-${e.color}-500/20`,children:(0,t.jsx)(e.icon,{size:20})}),(0,t.jsx)("span",{className:`text-xs font-bold px-2 py-1 rounded-full bg-${e.color}-500/10 text-${e.color}-400 flex items-center gap-1`,children:e.trend})]}),(0,t.jsx)("h3",{className:"text-3xl font-black text-white mb-1",children:e.value}),(0,t.jsx)("p",{className:"text-slate-400 text-sm font-medium uppercase tracking-wide",children:e.label})]})]},l))}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 bg-zinc-900/40 backdrop-blur-xl border border-white/10 rounded-3xl p-8 flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[(0,t.jsx)(s.FaClock,{className:"text-indigo-500"}),"Recent Activity"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>f(e=>Math.max(1,e-1)),disabled:1===g,className:"px-3 py-1 text-xs font-bold bg-white/5 hover:bg-white/10 disabled:opacity-30 rounded-lg transition-colors border border-white/5",children:"Previous"}),(0,t.jsxs)("span",{className:"text-xs font-mono self-center text-slate-500",children:["Page ",g," of ",v||1]}),(0,t.jsx)("button",{onClick:()=>f(e=>Math.min(v,e+1)),disabled:g===v||0===v,className:"px-3 py-1 text-xs font-bold bg-white/5 hover:bg-white/10 disabled:opacity-30 rounded-lg transition-colors border border-white/5",children:"Next"})]})]}),(0,t.jsxs)("div",{className:"space-y-4 flex-1",children:[0===j.length&&!x&&(0,t.jsx)("div",{className:"text-center py-8 text-slate-500 italic",children:"No recent activity found."}),j.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-zinc-950/50 hover:bg-zinc-900/50 transition-colors border border-white/10 group",children:[(0,t.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl border border-white/10 
                                    ${"complaint"===e.type?"bg-amber-500/20 text-amber-500":"bg-purple-500/20 text-purple-500"}
                                `,children:"complaint"===e.type?(0,t.jsx)(s.FaExclamationCircle,{}):(0,t.jsx)(s.FaBullhorn,{})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("p",{className:"text-slate-200 font-medium text-sm",children:[(0,t.jsx)("span",{className:"text-slate-400 font-bold text-[10px] uppercase mr-2 tracking-wider px-1.5 py-0.5 rounded bg-white/5",children:e.department}),e.description]}),(0,t.jsxs)("p",{className:"text-slate-500 text-[10px] mt-1 flex items-center gap-2",children:[(0,t.jsx)("span",{children:e.author}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsx)("span",{children:e.timestamp?.toDate?e.timestamp.toDate().toLocaleString():"string"==typeof e.timestamp?new Date(e.timestamp).toLocaleString():"Just now"})]})]}),(0,t.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(o.default,{href:"complaint"===e.type?`/admin/complaints?dept=${e.department}`:`/admin/announcements?dept=${e.department}`,className:"text-[10px] font-bold text-indigo-400 hover:text-indigo-300 uppercase tracking-widest border border-indigo-500/30 px-3 py-1 rounded-lg hover:bg-indigo-500/10 transition-colors",children:"View"})})]},`${e.type}-${e.id}`))]})]}),(0,t.jsxs)("div",{className:"bg-black/20 backdrop-blur-xl border border-pink-500/20 rounded-3xl p-8 relative overflow-hidden flex flex-col justify-between",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-3 mb-4",children:[(0,t.jsx)(s.FaCode,{className:"text-pink-500"}),"System Updates"]}),(0,t.jsx)("p",{className:"text-slate-400 text-sm mb-6",children:"Stay up to date with the latest features, security patches, and improvements to the San Andreas Government portal."})]}),(0,t.jsx)("div",{className:"bg-white/5 rounded-2xl p-4 border border-white/5 mb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-white/10",children:(0,t.jsx)("img",{src:"/images/damon_icon.png",alt:"Dev",className:"w-full h-full object-cover"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-slate-300 font-bold",children:"Maintained by Damon"}),(0,t.jsx)("p",{className:"text-[10px] text-slate-500",children:"Certified Developer"})]})]})}),(0,t.jsxs)(o.default,{href:"/admin/changelog",className:"w-full py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2 border border-slate-700 group",children:["View Full Changelog",(0,t.jsx)(s.FaArrowUp,{className:"rotate-45 group-hover:translate-x-0.5 group-hover:-translate-y-0.5 transition-transform"})]})]})]})]})}e.s(["default",()=>n])}]);