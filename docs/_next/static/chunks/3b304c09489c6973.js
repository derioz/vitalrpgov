(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23476,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(22016);e.i(36180);var a=e.i(98925),l=e.i(59141),n=e.i(11152),o=e.i(32341),d=e.i(18566);function i(){let{userProfile:e}=(0,o.useAuth)(),i=(0,d.useSearchParams)().get("dept"),[c,x]=(0,r.useState)(i||"ALL"),[b,m]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{i?x(i):x("ALL")},[i]),(0,r.useEffect)(()=>{p()},[c]);let p=async()=>{h(!0);try{let e;e="ALL"!==c?(0,a.query)((0,a.collection)(l.db,"announcements"),(0,a.where)("department","==",c),(0,a.orderBy)("createdAt","desc")):(0,a.query)((0,a.collection)(l.db,"announcements"),(0,a.orderBy)("createdAt","desc"));let t=(await (0,a.getDocs)(e)).docs.map(e=>({id:e.id,...e.data()}));m(t)}catch(e){console.error("Error fetching announcements:",e)}finally{h(!1)}},g=async e=>{if(confirm("Are you sure you want to delete this announcement?"))try{await (0,a.deleteDoc)((0,a.doc)(l.db,"announcements",e)),p()}catch(e){console.error("Error deleting:",e),alert("Failed to delete.")}},f=e?.roles?.includes("admin");return(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-slate-900/40 backdrop-blur-xl border border-white/5 p-6 rounded-3xl",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-black text-white flex items-center gap-3",children:[(0,t.jsx)(n.FaBullhorn,{className:"text-blue-500"}),"ALL"!==c?`${c} Announcements`:"All Announcements"]}),(0,t.jsx)("p",{className:"text-slate-400 mt-1",children:"ALL"!==c?`Manage updates for the ${c} portal.`:"Broadcast updates to department portals."})]}),(0,t.jsxs)(s.default,{href:`/admin/announcements/new?dept=${"ALL"!==c?c:""}`,className:"bg-blue-600 text-white px-6 py-3 rounded-xl font-bold flex items-center gap-2 hover:bg-blue-500 transition shadow-lg shadow-blue-600/20",children:[(0,t.jsx)(n.FaPlus,{})," New Announcement"]})]}),!i&&(0,t.jsxs)("div",{className:"flex items-center gap-3 overflow-x-auto pb-2",children:[(0,t.jsx)(n.FaFilter,{className:"text-slate-500 ml-2"}),(0,t.jsx)("button",{onClick:()=>x("ALL"),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all border ${"ALL"===c?"bg-white text-slate-900 border-white":"bg-slate-900/50 text-slate-400 border-white/10 hover:bg-white/10"}`,children:"ALL"}),["LSPD","LSEMS","SAFD","DOJ"].map(e=>(0,t.jsx)("button",{onClick:()=>x(e),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all border ${c===e?"bg-white text-slate-900 border-white":"bg-slate-900/50 text-slate-400 border-white/10 hover:bg-white/10"}`,children:e},e))]}),u?(0,t.jsx)("div",{className:"text-center py-20 text-slate-500 animate-pulse",children:"Loading feed..."}):(0,t.jsxs)("div",{className:"grid gap-4",children:[b.map(r=>(0,t.jsxs)("div",{className:"bg-slate-900/40 backdrop-blur-md border border-white/5 p-6 rounded-2xl flex flex-col md:flex-row items-start md:items-center justify-between gap-6 hover:bg-slate-800/40 transition-colors group",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("span",{className:`px-2 py-0.5 rounded text-[10px] font-black uppercase tracking-widest ${"LSPD"===r.department?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"LSEMS"===r.department?"bg-red-500/20 text-red-300 border border-red-500/30":"SAFD"===r.department?"bg-orange-500/20 text-orange-300 border border-orange-500/30":"bg-amber-500/20 text-amber-300 border border-amber-500/30"}`,children:r.department}),(0,t.jsx)("span",{className:"text-slate-500 text-xs font-mono",children:r.createdAt?.toDate().toLocaleDateString()})]}),(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-1 group-hover:text-blue-400 transition-colors",children:r.title}),(0,t.jsxs)("p",{className:"text-slate-400 text-sm line-clamp-1",children:["by ",r.author]})]}),(f||r.author===e?.email)&&(0,t.jsx)("button",{onClick:()=>g(r.id),className:"p-3 rounded-xl bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white transition-all border border-red-500/20",title:"Delete Announcement",children:(0,t.jsx)(n.FaTrash,{})})]},r.id)),0===b.length&&(0,t.jsxs)("div",{className:"text-center py-20 text-slate-500 bg-slate-900/20 rounded-3xl border border-dashed border-slate-800",children:["No announcements found for ",c,"."]})]})]})}e.s(["default",()=>i])}]);