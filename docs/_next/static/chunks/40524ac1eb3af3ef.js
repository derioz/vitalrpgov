(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98723,e=>{"use strict";var t=e.i(43476),l=e.i(71645),s=e.i(11152),r=e.i(32341);e.i(36180);var a=e.i(98925),i=e.i(59141),o=e.i(22016),n=e.i(88760);function c({onOpenChangelog:e}){let{openChangelog:c}=(0,n.useAdminUI)(),{userProfile:d}=(0,r.useAuth)(),[m,p]=(0,l.useState)([{label:"Total Users",value:"-",icon:s.FaUsers,color:"blue",trend:"..."},{label:"Active Complaints",value:"-",icon:s.FaExclamationCircle,color:"amber",trend:"..."},{label:"Total Personnel",value:"-",icon:s.FaUserShield,color:"purple",trend:"..."},{label:"Open Jobs",value:"-",icon:s.FaBriefcase,color:"emerald",trend:"..."}]),[x,h]=(0,l.useState)([]),[u,b]=(0,l.useState)(!0),g=d?.roles?.includes("superadmin");d?.roles?.includes("admin");let f=d?.roles?.filter(e=>["lspd","lsems","safd","doj"].includes(e)).map(e=>e.toUpperCase())||[],v=async()=>{if(d){b(!0);try{let e,t,l,r,o,n="Restricted";if(g)try{n=(await (0,a.getCountFromServer)((0,a.collection)(i.db,"users"))).data().count.toLocaleString()}catch(e){console.warn("User count failed",e)}else n="N/A";e=g?(0,a.query)((0,a.collection)(i.db,"complaints"),(0,a.where)("status","!=","Resolved")):f.length>0?(0,a.query)((0,a.collection)(i.db,"complaints"),(0,a.where)("status","!=","Resolved"),(0,a.where)("department","in",f)):null;let c="-";e&&(c=(await (0,a.getCountFromServer)(e)).data().count.toString()),t=g?(0,a.query)((0,a.collection)(i.db,"rosters")):f.length>0?(0,a.query)((0,a.collection)(i.db,"rosters"),(0,a.where)("department","in",f)):null;let d="-";t&&(d=(await (0,a.getCountFromServer)(t)).data().count.toString()),l=g?(0,a.query)((0,a.collection)(i.db,"jobs")):f.length>0?(0,a.query)((0,a.collection)(i.db,"jobs"),(0,a.where)("department","in",f)):null;let m="-";l&&(m=(await (0,a.getCountFromServer)(l)).data().count.toString()),p([{label:"Total Users",value:n,icon:s.FaUsers,color:"blue",trend:g?"Registered":"Hidden"},{label:"Active Complaints",value:c,icon:s.FaExclamationCircle,color:"amber",trend:"Pending"},{label:"Personnel",value:d,icon:s.FaUserShield,color:"purple",trend:"On Roster"},{label:"Open Jobs",value:m,icon:s.FaBriefcase,color:"emerald",trend:"Available"}]);let x=[];g?r=(0,a.query)((0,a.collection)(i.db,"complaints"),(0,a.orderBy)("createdAt","desc"),(0,a.limit)(50)):f.length>0&&(r=(0,a.query)((0,a.collection)(i.db,"complaints"),(0,a.where)("department","in",f),(0,a.orderBy)("createdAt","desc"),(0,a.limit)(50))),r&&(await (0,a.getDocs)(r)).forEach(e=>{let t=e.data();x.push({id:e.id,type:"complaint",department:t.department,description:`Complaint #${t.accessCode||e.id.substring(0,6)}`,timestamp:t.createdAt,author:"System"})}),g?o=(0,a.query)((0,a.collection)(i.db,"announcements"),(0,a.orderBy)("createdAt","desc"),(0,a.limit)(50)):f.length>0&&(o=(0,a.query)((0,a.collection)(i.db,"announcements"),(0,a.where)("department","in",f),(0,a.orderBy)("createdAt","desc"),(0,a.limit)(50))),o&&(await (0,a.getDocs)(o)).forEach(e=>{let t=e.data();x.push({id:e.id,type:"announcement",department:t.department,description:`Announcement: "${t.title}"`,timestamp:t.createdAt,author:t.author||"Admin"})}),x.sort((e,t)=>{let l=e.timestamp?.seconds||0;return(t.timestamp?.seconds||0)-l}),h(x.slice(0,7))}catch(e){console.error("Dashboard fetch error:",e)}finally{b(!1)}}};(0,l.useEffect)(()=>{v()},[d,g]);let[j,y]=(0,l.useState)(1),w=Math.ceil(x.length/5),N=x.slice((j-1)*5,5*j);return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-slate-200",children:["Overview",f.length>0&&!g&&(0,t.jsxs)("span",{className:"text-sm font-normal text-slate-500 ml-2",children:["(",f.join(", "),")"]}),g&&(0,t.jsx)("span",{className:"text-sm font-normal text-slate-500 ml-2",children:"(Global Access)"})]}),u&&(0,t.jsxs)("div",{className:"text-indigo-400 flex items-center gap-2 text-sm",children:[(0,t.jsx)(s.FaSpinner,{className:"animate-spin"})," Syncing data..."]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:m.map((e,l)=>(0,t.jsxs)("div",{className:"bg-zinc-900/40 backdrop-blur-xl border border-white/10 p-6 rounded-3xl relative overflow-hidden group hover:bg-zinc-800/40 transition-all duration-300",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:(0,t.jsx)(e.icon,{className:`text-6xl text-${e.color}-500 transform rotate-12`})}),(0,t.jsxs)("div",{className:"relative z-10",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("div",{className:`p-3 rounded-xl bg-${e.color}-500/10 text-${e.color}-500 border border-${e.color}-500/20`,children:(0,t.jsx)(e.icon,{size:20})}),(0,t.jsx)("span",{className:`text-xs font-bold px-2 py-1 rounded-full bg-${e.color}-500/10 text-${e.color}-400 flex items-center gap-1`,children:e.trend})]}),(0,t.jsx)("h3",{className:"text-3xl font-black text-white mb-1",children:e.value}),(0,t.jsx)("p",{className:"text-slate-400 text-sm font-medium uppercase tracking-wide",children:e.label})]})]},l))}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 bg-zinc-900/40 backdrop-blur-xl border border-white/10 rounded-3xl p-8 flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[(0,t.jsx)(s.FaClock,{className:"text-indigo-500"}),"Recent Activity"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>y(e=>Math.max(1,e-1)),disabled:1===j,className:"px-3 py-1 text-xs font-bold bg-white/5 hover:bg-white/10 disabled:opacity-30 rounded-lg transition-colors border border-white/5",children:"Previous"}),(0,t.jsxs)("span",{className:"text-xs font-mono self-center text-slate-500",children:["Page ",j," of ",w||1]}),(0,t.jsx)("button",{onClick:()=>y(e=>Math.min(w,e+1)),disabled:j===w||0===w,className:"px-3 py-1 text-xs font-bold bg-white/5 hover:bg-white/10 disabled:opacity-30 rounded-lg transition-colors border border-white/5",children:"Next"})]})]}),(0,t.jsxs)("div",{className:"space-y-4 flex-1",children:[0===N.length&&!u&&(0,t.jsx)("div",{className:"text-center py-8 text-slate-500 italic",children:"No recent activity found."}),N.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-zinc-950/50 hover:bg-zinc-900/50 transition-colors border border-white/10 group",children:[(0,t.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl border border-white/10 
                                    ${"complaint"===e.type?"bg-amber-500/20 text-amber-500":"bg-purple-500/20 text-purple-500"}
                                `,children:"complaint"===e.type?(0,t.jsx)(s.FaExclamationCircle,{}):(0,t.jsx)(s.FaBullhorn,{})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("p",{className:"text-slate-200 font-medium text-sm",children:[(0,t.jsx)("span",{className:"text-slate-400 font-bold text-[10px] uppercase mr-2 tracking-wider px-1.5 py-0.5 rounded bg-white/5",children:e.department}),e.description]}),(0,t.jsxs)("p",{className:"text-slate-500 text-[10px] mt-1 flex items-center gap-2",children:[(0,t.jsx)("span",{children:e.author}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsx)("span",{children:e.timestamp?.toDate?e.timestamp.toDate().toLocaleString():"string"==typeof e.timestamp?new Date(e.timestamp).toLocaleString():"Just now"})]})]}),(0,t.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(o.default,{href:"complaint"===e.type?`/admin/complaints?dept=${e.department}`:`/admin/announcements?dept=${e.department}`,className:"text-[10px] font-bold text-indigo-400 hover:text-indigo-300 uppercase tracking-widest border border-indigo-500/30 px-3 py-1 rounded-lg hover:bg-indigo-500/10 transition-colors",children:"View"})})]},`${e.type}-${e.id}`))]})]}),(0,t.jsxs)("div",{className:"bg-black/20 backdrop-blur-xl border border-pink-500/20 rounded-3xl p-8 relative overflow-hidden flex flex-col justify-between",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-3 mb-4",children:[(0,t.jsx)(s.FaCode,{className:"text-pink-500"}),"System Updates"]}),(0,t.jsx)("p",{className:"text-slate-400 text-sm mb-6",children:"Stay up to date with the latest features, security patches, and improvements to the San Andreas Government portal."})]}),(0,t.jsx)("div",{className:"bg-white/5 rounded-2xl p-4 border border-white/5 mb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-white/10",children:(0,t.jsx)("img",{src:"/images/damon_icon.png",alt:"Dev",className:"w-full h-full object-cover"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-slate-300 font-bold",children:"Maintained by Damon"}),(0,t.jsx)("p",{className:"text-[10px] text-slate-500",children:"Certified Developer"})]})]})}),(0,t.jsxs)("div",{onClick:e||c,className:"w-full py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2 border border-slate-700 group cursor-pointer",children:["View Full Changelog",(0,t.jsx)(s.FaArrowUp,{className:"rotate-45 group-hover:translate-x-0.5 group-hover:-translate-y-0.5 transition-transform"})]})]})]})]})}e.s(["default",()=>c])}]);