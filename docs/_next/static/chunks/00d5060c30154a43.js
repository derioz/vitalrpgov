(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20675,e=>{"use strict";var t=e.i(43476),s=e.i(71645);e.i(36180);var a=e.i(98925),r=e.i(59141),l=e.i(11152);function d(){let[e,d]=(0,s.useState)(""),[i,n]=(0,s.useState)(null),[o,c]=(0,s.useState)(!1),[b,x]=(0,s.useState)(""),[u,m]=(0,s.useState)(""),[p,h]=(0,s.useState)(!1),g=async t=>{if(t.preventDefault(),e.trim()){c(!0),x(""),n(null);try{let t=(0,a.query)((0,a.collection)(r.db,"complaints"),(0,a.where)("accessCode","==",e.trim())),s=await (0,a.getDocs)(t);if(s.empty)x("Invalid Access Code. Please check and try again.");else{let e=s.docs[0],t={id:e.id,...e.data()};n(t),t.isReadByUser||await (0,a.updateDoc)((0,a.doc)(r.db,"complaints",e.id),{isReadByUser:!0})}}catch(e){console.error(e),x("System error. Please try again later.")}finally{c(!1)}}},f=async e=>{if(e.preventDefault(),u.trim()&&i){h(!0);try{let e={sender:i.name,role:"civilian",content:u,timestamp:new Date().toISOString()},t=(0,a.doc)(r.db,"complaints",i.id);await (0,a.updateDoc)(t,{messages:(0,a.arrayUnion)(e),isReadByAdmin:!1}),n(t=>t?{...t,messages:[...t.messages,e]}:null),m("")}catch(e){console.error(e),alert("Failed to send reply.")}finally{h(!1)}}};return(0,t.jsxs)("div",{className:"w-full max-w-2xl mx-auto",children:[!i&&(0,t.jsxs)("div",{className:"bg-white/10 backdrop-blur-md p-8 rounded-3xl border border-white/10 shadow-xl",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold text-white mb-4 text-center",children:"Check Complaint Status"}),(0,t.jsxs)("form",{onSubmit:g,className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:e,onChange:e=>d(e.target.value.toUpperCase()),placeholder:"Enter Check Code (e.g. CP-X9Y2)",className:"flex-1 bg-slate-900/50 border border-slate-700 text-white p-4 rounded-xl font-mono text-lg tracking-widest uppercase placeholder:normal-case placeholder:tracking-normal focus:ring-2 focus:ring-blue-500 outline-none"}),(0,t.jsx)("button",{type:"submit",disabled:o,className:"bg-blue-600 hover:bg-blue-500 text-white px-8 rounded-xl font-bold transition-colors disabled:opacity-50",children:o?"Searching...":(0,t.jsx)(l.FaSearch,{})})]}),b&&(0,t.jsx)("p",{className:"text-red-400 mt-4 text-center bg-red-900/20 p-2 rounded-lg border border-red-500/20",children:b})]}),i&&(0,t.jsxs)("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl overflow-hidden border border-slate-200 dark:border-slate-800 animate-fade-in-up",children:[(0,t.jsxs)("div",{className:"p-6 bg-slate-50 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:[i.department," INTERNAL AFFAIRS"]}),(0,t.jsxs)("h2",{className:"text-xl font-bold text-slate-900 dark:text-white mt-1",children:["Case #",i.accessCode]})]}),(0,t.jsx)("div",{className:`px-4 py-1.5 rounded-full text-sm font-bold uppercase tracking-wider ${"Resolved"===i.status?"bg-green-100 text-green-700":"Dismissed"===i.status?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:i.status})]}),(0,t.jsx)("div",{className:"h-96 overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-slate-300 dark:scrollbar-thumb-slate-700 bg-slate-100 dark:bg-slate-950/50",children:(0,t.jsx)("div",{className:"space-y-6",children:i.messages.map((e,s)=>(0,t.jsx)("div",{className:`flex ${"civilian"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsxs)("div",{className:`max-w-[80%] rounded-2xl p-4 shadow-sm ${"civilian"===e.role?"bg-blue-600 text-white rounded-tr-none":"bg-white dark:bg-slate-800 text-slate-800 dark:text-slate-200 border border-slate-200 dark:border-slate-700 rounded-tl-none"}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2 text-xs opacity-70",children:["official"===e.role?(0,t.jsx)(l.FaShieldAlt,{}):(0,t.jsx)(l.FaUser,{}),(0,t.jsx)("span",{className:"font-bold uppercase",children:e.sender}),(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("span",{className:"font-mono",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)("p",{className:"whitespace-pre-wrap leading-relaxed",children:e.content})]})},s))})}),(0,t.jsxs)("div",{className:"p-4 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800",children:[(0,t.jsxs)("form",{onSubmit:f,className:"flex gap-3",children:[(0,t.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"Type your reply...",disabled:"Pending"!==i.status&&"Under Investigation"!==i.status,className:"flex-1 bg-slate-100 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),(0,t.jsx)("button",{type:"submit",disabled:p||"Pending"!==i.status&&"Under Investigation"!==i.status,className:"bg-blue-600 hover:bg-blue-500 text-white p-4 rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?(0,t.jsx)("span",{className:"animate-spin text-xl",children:"↻"}):(0,t.jsx)(l.FaPaperPlane,{})})]}),"Resolved"===i.status&&(0,t.jsx)("p",{className:"text-center text-xs text-green-600 mt-2 font-bold",children:"This case has been resolved. Replies are closed."})]}),(0,t.jsx)("button",{onClick:()=>n(null),className:"w-full py-3 bg-slate-50 dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 text-slate-500 hover:text-slate-800 dark:hover:text-white transition-colors text-sm font-bold uppercase tracking-widest",children:"Close Case View"})]})]})}e.s(["default",()=>d])}]);