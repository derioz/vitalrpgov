(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98723,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(11152),a=e.i(32341);e.i(36180);var r=e.i(98925),o=e.i(59141),n=e.i(22016),i=e.i(18789);function c({changelogs:e}){let{userProfile:c}=(0,a.useAuth)(),[d,m]=(0,s.useState)([{label:"Total Users",value:"-",icon:l.FaUsers,color:"blue",trend:"..."},{label:"Active Complaints",value:"-",icon:l.FaExclamationCircle,color:"amber",trend:"..."},{label:"Total Personnel",value:"-",icon:l.FaUserShield,color:"purple",trend:"..."},{label:"Open Jobs",value:"-",icon:l.FaBriefcase,color:"emerald",trend:"..."}]),[p,x]=(0,s.useState)([]),[u,h]=(0,s.useState)(!0),b=c?.roles?.includes("superadmin");c?.roles?.includes("admin");let g=c?.roles?.filter(e=>["lspd","lsems","safd","doj"].includes(e)).map(e=>e.toUpperCase())||[],v=async()=>{if(c){h(!0);try{let e,t,s,a,n,i="Restricted";if(b)try{i=(await (0,r.getCountFromServer)((0,r.collection)(o.db,"users"))).data().count.toLocaleString()}catch(e){console.warn("User count failed",e)}else i="N/A";e=b?(0,r.query)((0,r.collection)(o.db,"complaints"),(0,r.where)("status","!=","Resolved")):g.length>0?(0,r.query)((0,r.collection)(o.db,"complaints"),(0,r.where)("status","!=","Resolved"),(0,r.where)("department","in",g)):null;let c="-";e&&(c=(await (0,r.getCountFromServer)(e)).data().count.toString()),t=b?(0,r.query)((0,r.collection)(o.db,"rosters")):g.length>0?(0,r.query)((0,r.collection)(o.db,"rosters"),(0,r.where)("department","in",g)):null;let d="-";t&&(d=(await (0,r.getCountFromServer)(t)).data().count.toString()),s=b?(0,r.query)((0,r.collection)(o.db,"jobs")):g.length>0?(0,r.query)((0,r.collection)(o.db,"jobs"),(0,r.where)("department","in",g)):null;let p="-";s&&(p=(await (0,r.getCountFromServer)(s)).data().count.toString()),m([{label:"Total Users",value:i,icon:l.FaUsers,color:"blue",trend:b?"Registered":"Hidden"},{label:"Active Complaints",value:c,icon:l.FaExclamationCircle,color:"amber",trend:"Pending"},{label:"Personnel",value:d,icon:l.FaUserShield,color:"purple",trend:"On Roster"},{label:"Open Jobs",value:p,icon:l.FaBriefcase,color:"emerald",trend:"Available"}]);let u=[];b?a=(0,r.query)((0,r.collection)(o.db,"complaints"),(0,r.orderBy)("createdAt","desc"),(0,r.limit)(5)):g.length>0&&(a=(0,r.query)((0,r.collection)(o.db,"complaints"),(0,r.where)("department","in",g),(0,r.orderBy)("createdAt","desc"),(0,r.limit)(5))),a&&(await (0,r.getDocs)(a)).forEach(e=>{let t=e.data();u.push({id:e.id,type:"complaint",department:t.department,description:`New Complaint filed against ${t.department}`,timestamp:t.createdAt,author:"System"})}),b?n=(0,r.query)((0,r.collection)(o.db,"announcements"),(0,r.orderBy)("createdAt","desc"),(0,r.limit)(5)):g.length>0&&(n=(0,r.query)((0,r.collection)(o.db,"announcements"),(0,r.where)("department","in",g),(0,r.orderBy)("createdAt","desc"),(0,r.limit)(5))),n&&(await (0,r.getDocs)(n)).forEach(e=>{let t=e.data();u.push({id:e.id,type:"announcement",department:t.department,description:`Announcement posted: "${t.title}"`,timestamp:t.createdAt,author:t.author||"Admin"})}),u.sort((e,t)=>{let s=e.timestamp?.seconds||0;return(t.timestamp?.seconds||0)-s}),x(u.slice(0,7))}catch(e){console.error("Dashboard fetch error:",e)}finally{h(!1)}}};return(0,s.useEffect)(()=>{v()},[c,b]),(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-slate-200",children:["Overview",g.length>0&&!b&&(0,t.jsxs)("span",{className:"text-sm font-normal text-slate-500 ml-2",children:["(",g.join(", "),")"]}),b&&(0,t.jsx)("span",{className:"text-sm font-normal text-slate-500 ml-2",children:"(Global Access)"})]}),u&&(0,t.jsxs)("div",{className:"text-indigo-400 flex items-center gap-2 text-sm",children:[(0,t.jsx)(l.FaSpinner,{className:"animate-spin"})," Syncing data..."]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:d.map((e,s)=>(0,t.jsxs)("div",{className:"bg-slate-900/40 backdrop-blur-xl border border-white/5 p-6 rounded-3xl relative overflow-hidden group hover:bg-slate-800/40 transition-all duration-300",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:(0,t.jsx)(e.icon,{className:`text-6xl text-${e.color}-500 transform rotate-12`})}),(0,t.jsxs)("div",{className:"relative z-10",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("div",{className:`p-3 rounded-xl bg-${e.color}-500/10 text-${e.color}-500 border border-${e.color}-500/20`,children:(0,t.jsx)(e.icon,{size:20})}),(0,t.jsx)("span",{className:`text-xs font-bold px-2 py-1 rounded-full bg-${e.color}-500/10 text-${e.color}-400 flex items-center gap-1`,children:e.trend})]}),(0,t.jsx)("h3",{className:"text-3xl font-black text-white mb-1",children:e.value}),(0,t.jsx)("p",{className:"text-slate-400 text-sm font-medium uppercase tracking-wide",children:e.label})]})]},s))}),(0,t.jsxs)("div",{className:"bg-slate-900/40 backdrop-blur-xl border border-white/5 rounded-3xl p-8",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-3",children:[(0,t.jsx)(l.FaClock,{className:"text-indigo-500"}),"Recent Activity"]}),(0,t.jsxs)("div",{className:"space-y-4",children:[0===p.length&&!u&&(0,t.jsx)("div",{className:"text-center py-8 text-slate-500 italic",children:"No recent activity found."}),p.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/5 hover:bg-white/10 transition-colors border border-white/5 group",children:[(0,t.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl border border-white/10 
                                ${"complaint"===e.type?"bg-amber-500/20 text-amber-500":"bg-purple-500/20 text-purple-500"}
                            `,children:"complaint"===e.type?(0,t.jsx)(l.FaExclamationCircle,{}):(0,t.jsx)(l.FaBullhorn,{})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("p",{className:"text-slate-200 font-medium",children:[(0,t.jsx)("span",{className:"text-slate-400 font-bold text-xs uppercase mr-2 tracking-wider px-1.5 py-0.5 rounded bg-white/5",children:e.department}),e.description]}),(0,t.jsxs)("p",{className:"text-slate-500 text-xs mt-1 flex items-center gap-2",children:[(0,t.jsx)("span",{children:e.author}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsx)("span",{children:e.timestamp?.toDate?e.timestamp.toDate().toLocaleString():"Just now"})]})]}),(0,t.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(n.default,{href:"complaint"===e.type?`/admin/complaints?dept=${e.department}`:`/admin/announcements?dept=${e.department}`,className:"text-xs font-bold text-indigo-400 hover:text-indigo-300 uppercase tracking-widest",children:"View"})})]},`${e.type}-${e.id}`))]})]}),(0,t.jsxs)("div",{className:"bg-black/20 backdrop-blur-xl border border-indigo-500/20 rounded-3xl p-8 relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"}),(0,t.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,t.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[(0,t.jsx)(l.FaCode,{className:"text-pink-500"}),"Developer Changelog"]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[0===e.length&&(0,t.jsx)("div",{className:"text-center py-6 text-slate-500 italic",children:"No changelogs found."}),e.map(e=>(0,t.jsxs)("div",{className:"relative pl-6 border-l-2 border-slate-700 hover:border-indigo-500 transition-colors",children:[(0,t.jsx)("span",{className:"absolute -left-[5px] top-0 w-2.5 h-2.5 rounded-full bg-slate-700 border-2 border-slate-900 group-hover:bg-indigo-500"}),(0,t.jsxs)("div",{className:"flex items-baseline gap-3 mb-1",children:[(0,t.jsx)("span",{className:"text-sm font-bold text-pink-400 font-mono bg-pink-500/10 px-2 py-0.5 rounded",children:e.version}),(0,t.jsx)("h3",{className:"text-white font-bold",children:e.title}),(0,t.jsx)("span",{className:"text-xs text-slate-500 ml-auto",children:e.date||"Unknown Date"})]}),(0,t.jsx)("div",{className:"text-slate-400 text-sm prose prose-invert prose-sm max-w-none prose-p:leading-relaxed prose-pre:bg-slate-900/50 prose-pre:border prose-pre:border-white/10",children:(0,t.jsx)(i.default,{children:e.content})}),(0,t.jsxs)("p",{className:"text-slate-500 text-[10px] mt-2 font-mono uppercase",children:["Posted by ",e.author]})]},e.id))]})]})]})}e.s(["default",()=>c])}]);